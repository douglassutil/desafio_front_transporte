<section class="container-delivery">
    <div class="container-group">
        <h6>Visão Geral de Entregas</h6>

        <div class="container-table" tabindex="0">
            @if (deliveryPanelDataSource$ | async; as deliveryPanelDataSource) {
                <div class="container-filter">
                    <mat-form-field>
                        <mat-label>Tipo de filtro</mat-label>
                        <mat-select [(ngModel)]="selectedValue" name="food">
                            <mat-option>Limpar Filtro</mat-option>
                            <mat-option value="driver">Motorista</mat-option>
                            <mat-option value="status">Status</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field class="form-field-filter">
                        <input matInput type="text" (ngModelChange)="modelChanged($event)" [(ngModel)]="valueFilter">
                        @if (valueFilter) {
                          <button matSuffix mat-icon-button aria-label="Clear" (click)="valueFilter=''">
                            <mat-icon>close</mat-icon>
                          </button>
                        }
                    </mat-form-field>
                </div>
                @if (deliveryPanelDataSource.status == "success") {
                    <table mat-table [dataSource]="deliveryPanelDataSource.deliveryPanelResult.deliveryPanel">
                        <ng-container matColumnDef="Driver">
                            <th mat-header-cell *matHeaderCellDef> Motorista </th>
                            <td mat-cell *matCellDef="let element"> {{element.driver}} </td>
                        </ng-container>
            
                        <ng-container matColumnDef="Neighborhood">
                            <th mat-header-cell *matHeaderCellDef> Bairro de Entrega </th>
                            <td mat-cell *matCellDef="let element"> {{element.neighborhood}} </td>
                        </ng-container>
            
                        <ng-container matColumnDef="Status">
                            <th mat-header-cell *matHeaderCellDef> Situação </th>
                            <td mat-cell *matCellDef="let element"> {{element.status}} </td>
                        </ng-container>
            
                        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    </table>

                    <div class="container-buttons">
                        <button (click)="decrement()" mat-mini-fab aria-label="button remove">
                            <mat-icon>remove</mat-icon>
                        </button>
                        <div class="counter-number">{{counter}}</div>                        
                        <button (click)="(deliveryPanelDataSource.deliveryPanelResult.totalPages > counter) ? increment() : null" mat-mini-fab aria-label="button add">
                            <mat-icon>add</mat-icon>
                        </button>
                    </div>
                }
            }
        </div>
    </div>
</section>